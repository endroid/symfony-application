#!/usr/bin/env bash

set -e

rm -rf symfony-start

curl -sS https://getcomposer.org/installer | php -- --filename=composer

php -d memory_limit=-1 composer install --prefer-dist --no-interaction --no-progress

# Always start from website skeleton
php -d memory_limit=-1 composer create-project symfony/website-skeleton symfony-start --no-install -q

vendor/bin/teleport development symfony-start $@

(
    cd symfony-start/vendor
    ln -s ../../vendor/endroid endroid
)

(
    cd symfony-start
    bin/create
    rm -rf bin/create

    cp composer.lock ../development/composer.lock
    cp composer.json ../development/composer.json

    git add -A
    git commit -m "Initial commit" -q
)
